CREATE OR REPLACE TABLE kimia_farma.branch_rating_summary AS
SELECT
  branch_id,
  branch_name,
  provinsi,
  AVG(rating_cabang) AS avg_rating_cabang,
  AVG(rating_transaksi) AS avg_rating_transaksi,
  COUNT(transaction_id) AS total_transaksi
FROM kimia_farma.analysis_table
GROUP BY
  branch_id,
  branch_name,
  provinsi;
